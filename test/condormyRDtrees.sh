#!/bin/bash
#
# This script generates a text file that can be read by a "condor_submit" command, submitting jobs to the condor queue
# for processing. The jobs are dedicated to 'reducing' lnujj ntuples using the kana*.C scripts. The beauty of this
# setup is that it does not require you to have a working area yourself; you can copy someone else's working area
# entirely (assuming you have read permissions) and run these scripts in batch to create a set of reduced trees that
# end up in whatever destination you choose, or mix and match; take the code from one area and the tables from another.
# Caveat emptor; this script cannot compensate for dumb choices.
#
# Instructions for use:
#
# 1. Create/Locate a ElectroWeakAnalysis/VplusJets/test working area. The regular MyRunElec.C and MyRunMuon.C scripts
#    should have been used to compile the complete set of code necessary to run the associated kana*.C scripts.
#
# 2. Edit the environment variables below to tell the script where to find things. The "transfer_input_files" field
#    is a comma-separated list that tells condor what files to transfer to the worker node before starting processing.
#
# 3. Edit the list of tree codes in the loop at bottom for the trees you want processed. The codes are interpreted
#    by kana*.C.
#
# 4. 'cd' to a directory that has the disk/quota space to receive all the output once it's done. I suggest 3DayLifetime
#    scratch space. Condor will deliver your output to this directory. You can copy from there to eos or dcache
#    once you've verified the output.
# 
# 4. Run this script, generate 'submit.txt'
#
# 5. Let 'er rip: "condor_submit submit.txt"
#
MYSRCDIR=${LOCALRT}/src/ElectroWeakAnalysis/VPlusJets/
IFTABLEDIR=${MYSRCDIR}/test/InterferenceTable2012
EFFTABLEDIR=${MYSRCDIR}/test/EffTable2012
CLASSDIR=${MYSRCDIR}/test/ClassifierOut
executable=${MYSRCDIR}/test/Limits/batchit.sh
KANA=kanaelec
submit=submit.txt

printheader() {
cat >$submit <<EOF
Executable = $executable
Universe = vanilla
Requirements = Memory > 250 && FileSystemDomain=="fnal.gov" && Disk > 500000 && Arch=="X86_64"
Notification = ERROR
Should_Transfer_Files = YES
transfer_input_files =${MYSRCDIR}/test/MyRunElecBatch.C,${MYSRCDIR}/test/${KANA}_C.so,${MYSRCDIR}/test/Resolution_cc.so,${MYSRCDIR}/src/METzCalculator_cc.so,${MYSRCDIR}/src/QGLikelihoodCalculator_C.so,${MYSRCDIR}/test/EffTableReader_cc.so,${MYSRCDIR}/test/EffTableLoader_cc.so,${CLASSDIR}/TMVAClassification_1000_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_1000_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_126_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_126_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_170_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_170_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_170_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_170_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_170_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_170_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_180_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_180_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_180_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_180_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_180_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_180_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_190_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_190_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_190_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_190_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_190_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_190_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_200_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_200_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_200_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_200_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_200_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_200_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_250_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_250_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_250_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_250_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_250_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_250_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_300_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_300_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_300_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_300_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_300_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_300_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_350_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_350_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_350_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_350_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_350_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_350_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_400_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_450_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_500_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_550_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_VBF_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_VBF_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_el_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_mu_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_600_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_700_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_800_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ2_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ2_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ2_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ2_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ2_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ2_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ3_el_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ3_el_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ3_el_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ3_mu_interferencedown_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ3_mu_interferencenominal_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_900_nJ3_mu_interferenceup_Likelihood.class_C.so,${CLASSDIR}/TMVAClassification_noqg_nJ2_el_BDT.class_C.so,${CLASSDIR}/TMVAClassification_noqg_nJ2_mu_BDT.class_C.so,${CLASSDIR}/TMVAClassification_noqg_nJ3_el_BDT.class_C.so,${CLASSDIR}/TMVAClassification_noqg_nJ3_mu_BDT.class_C.so,${CLASSDIR}/TMVAClassification_withqg_nJ2_el_BDT.class_C.so,${CLASSDIR}/TMVAClassification_withqg_nJ2_mu_BDT.class_C.so,${CLASSDIR}/TMVAClassification_withqg_nJ3_el_BDT.class_C.so,${CLASSDIR}/TMVAClassification_withqg_nJ3_mu_BDT.class_C.so,$IFTABLEDIR/ratio400.txt,$IFTABLEDIR/ratio450.txt,$IFTABLEDIR/ratio500.txt,$IFTABLEDIR/ratio550.txt,$IFTABLEDIR/ratio600.txt,$IFTABLEDIR/ratio700.txt,$IFTABLEDIR/ratio800.txt,$IFTABLEDIR/ratio900.txt,$IFTABLEDIR/ratio1000.txt,$EFFTABLEDIR/scaleFactor-Run2012ABCD-GsfElectronToId.txt,$EFFTABLEDIR/scaleFactor-Run2012ABCD-SCToElectron.txt,$EFFTABLEDIR/efficiency-Run2012ABCD-WP80ToHLTEle.txt,$EFFTABLEDIR/FullyEfficient.txt,$EFFTABLEDIR/FullyEfficient_Jet2NoJet1.txt,$EFFTABLEDIR/FullyEfficient_MHT.txt,$MYSRCDIR/test/Data190456-208686_PileupHistogram.root
WhenToTransferOutput = ON_EXIT
EOF
}

printargs() {
cat >>$submit<<EOF
Error = ${KANA}_2012${treecode}.stderr
Output = ${KANA}_2012${treecode}.stdout
Arguments = ${MYSRCDIR} root -n -b -q -l MyRunElecBatch.C(2012${treecode},0,0)
Queue
EOF
}

printheader
#for treecode in 00001 1015 1016 1022 1037 1038 1039 1040 1002 1003 1004 1005 1006
for treecode in 1040
do
  printargs
done
